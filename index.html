<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Hand Selected</title>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@200;300;400;500&display=swap" rel="stylesheet">
<style>
:root {
  --cream: #F5F0E8;
  --ink: #161210;
  --gold: #C9A96E;
  --gold-lt: #E8D5B0;
  --gold-dim: rgba(201,169,110,0.15);
  --gold-border: rgba(201,169,110,0.25);
  --muted: #9A8E82;
  --div: #E8E0D4;
}
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
html, body { width: 100%; max-width: 430px; margin: 0 auto; height: 100vh; overflow: hidden; background: #111; font-family: 'DM Sans', sans-serif; font-weight: 300; -webkit-font-smoothing: antialiased; }

/* APP SHELL */
#app { width: 100%; height: 100vh; position: relative; overflow: hidden; }

/* SCREENS */
.screen { position: absolute; inset: 0; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; display: none; padding-bottom: 90px; }
.screen.active { display: block; }
.screen-light { background: var(--cream); }
.screen-dark { background: var(--ink); }

/* STATUS BAR */
.sb { height: 50px; flex-shrink: 0; }

/* TOP BAR */
.topbar { display: flex; align-items: center; justify-content: space-between; padding: 0 20px 14px; position: sticky; top: 0; z-index: 50; }
.topbar-light { background: rgba(245,240,232,0.95); backdrop-filter: blur(12px); }
.topbar-dark { background: rgba(22,18,16,0.95); backdrop-filter: blur(12px); }
.logo { font-family: 'Cormorant Garamond', serif; font-size: 19px; font-weight: 400; letter-spacing: 2.5px; text-transform: uppercase; }
.logo-dark { color: var(--ink); }
.logo-light { color: var(--cream); }
.logo span { color: var(--gold); }
.top-btns { display: flex; gap: 12px; align-items: center; }
.ibtn { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; border: none; background: none; cursor: pointer; position: relative; }
.ibtn svg { width: 22px; height: 22px; }
.ibtn-dark svg { color: var(--ink); }
.ibtn-light svg { color: var(--cream); }
.badge { position: absolute; top: 1px; right: 1px; width: 17px; height: 17px; background: var(--gold); color: var(--ink); border-radius: 50%; font-size: 9px; font-weight: 600; display: flex; align-items: center; justify-content: center; }

/* TAB BAR */
.tabbar { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 430px; height: 70px; background: rgba(22,18,16,0.97); backdrop-filter: blur(16px); border-top: 1px solid var(--gold-border); display: flex; align-items: flex-start; justify-content: space-around; padding-top: 10px; z-index: 100; }
.tab { display: flex; flex-direction: column; align-items: center; gap: 3px; flex: 1; cursor: pointer; border: none; background: none; color: rgba(245,240,232,0.3); transition: color 0.2s; padding: 2px 0; }
.tab.active { color: var(--gold); }
.tab svg { width: 21px; height: 21px; }
.tab span { font-size: 9px; letter-spacing: 1px; text-transform: uppercase; font-family: 'DM Sans', sans-serif; }
.scan-tab { width: 52px; height: 52px; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-top: -20px; border: 3px solid var(--ink); box-shadow: 0 4px 20px rgba(201,169,110,0.4); cursor: pointer; flex-shrink: 0; }
.scan-tab svg { width: 21px; height: 21px; color: var(--ink); }

/* TOAST */
.toast { position: fixed; bottom: 82px; left: 50%; transform: translateX(-50%) translateY(16px); background: var(--ink); color: var(--cream); padding: 11px 18px; border-radius: 24px; font-size: 12px; letter-spacing: 0.5px; z-index: 999; opacity: 0; transition: all 0.3s ease; white-space: nowrap; display: flex; align-items: center; gap: 8px; border: 1px solid var(--gold-border); pointer-events: none; }
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
.toast-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--gold); flex-shrink: 0; }

/* BACKDROP + SHEETS */
.backdrop { position: fixed; inset: 0; background: rgba(16,10,6,0.7); z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s; }
.backdrop.open { opacity: 1; pointer-events: all; }
.sheet { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%) translateY(100%); width: 100%; max-width: 430px; background: #FAF7F2; border-radius: 22px 22px 0 0; z-index: 201; transition: transform 0.38s cubic-bezier(0.4,0,0.2,1); max-height: 90vh; overflow-y: auto; -webkit-overflow-scrolling: touch; }
.sheet.open { transform: translateX(-50%) translateY(0); }
.sheet-dark { background: var(--ink); border: 1px solid var(--gold-border); border-bottom: none; }
.handle { width: 36px; height: 4px; background: var(--div); border-radius: 2px; margin: 12px auto 6px; }
.handle-dark { background: rgba(245,240,232,0.2); }

/* ─── DISCOVER SCREEN ─── */
.hero { margin: 0 16px 14px; border-radius: 20px; height: 350px; position: relative; overflow: hidden; cursor: pointer; background: linear-gradient(145deg, #2C2018, #4A3525, #1E1410); }
.hero::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 35% 30%, rgba(201,169,110,0.18) 0%, transparent 60%); }
.hero-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(16,10,6,0.92) 0%, transparent 55%); padding: 22px; display: flex; flex-direction: column; justify-content: flex-end; }
.hero-pill { display: inline-flex; align-items: center; gap: 6px; background: rgba(201,169,110,0.15); border: 1px solid rgba(201,169,110,0.35); padding: 4px 12px; border-radius: 20px; font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--gold-lt); margin-bottom: 10px; width: fit-content; }
.hero h2 { font-family: 'Cormorant Garamond', serif; font-size: 30px; font-weight: 300; color: var(--cream); line-height: 1.1; margin-bottom: 5px; }
.hero-sub { font-size: 12px; color: rgba(245,240,232,0.6); margin-bottom: 14px; }
.hero-cta { display: flex; align-items: center; justify-content: space-between; background: rgba(245,240,232,0.08); border: 1px solid rgba(245,240,232,0.18); border-radius: 10px; padding: 11px 15px; color: var(--cream); font-size: 12px; letter-spacing: 1px; }
.hero-cta span { color: var(--gold); font-size: 18px; }

.sec-head { display: flex; align-items: center; justify-content: space-between; padding: 0 20px; margin-bottom: 12px; }
.sec-title { font-family: 'Cormorant Garamond', serif; font-size: 21px; font-weight: 400; color: var(--ink); }
.sec-more { font-size: 11px; letter-spacing: 1px; color: var(--gold); background: none; border: none; cursor: pointer; font-family: 'DM Sans', sans-serif; }

.hscroll { display: flex; gap: 11px; overflow-x: auto; padding: 0 20px 4px; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
.hscroll::-webkit-scrollbar { display: none; }

.hotel-pill { flex-shrink: 0; width: 150px; border-radius: 13px; overflow: hidden; cursor: pointer; background: white; }
.hotel-pill-img { height: 100px; }
.hi-1 { background: linear-gradient(145deg, #1E2D33, #3D5058); }
.hi-2 { background: linear-gradient(145deg, #2A2820, #4A3D2E); }
.hi-3 { background: linear-gradient(145deg, #1A2820, #2E4535); }
.hi-4 { background: linear-gradient(145deg, #3D2E1E, #6B4E35); }
.hi-5 { background: linear-gradient(145deg, #2A2A2E, #3D3D50); }
.hotel-pill-img::before { content: ''; display: block; width: 100%; height: 100%; background: radial-gradient(ellipse at 40% 30%, rgba(201,169,110,0.15) 0%, transparent 70%); }
.hotel-pill-info { padding: 9px 11px; }
.hotel-pill-name { font-family: 'Cormorant Garamond', serif; font-size: 14px; line-height: 1.2; margin-bottom: 2px; color: var(--ink); }
.hotel-pill-loc { font-size: 10px; color: var(--muted); }

.chips { display: flex; gap: 8px; overflow-x: auto; padding: 0 20px 4px; scrollbar-width: none; }
.chips::-webkit-scrollbar { display: none; }
.chip { flex-shrink: 0; padding: 7px 15px; border-radius: 20px; font-size: 11px; letter-spacing: 1px; text-transform: uppercase; cursor: pointer; border: 1px solid var(--div); background: white; color: var(--muted); font-family: 'DM Sans', sans-serif; transition: all 0.2s; white-space: nowrap; }
.chip.active { background: var(--ink); color: var(--cream); border-color: var(--ink); }

.prod-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 3px; padding: 0 16px; }
.prod-card { position: relative; overflow: hidden; background: #0d0b09; cursor: pointer; border-radius: 0; transition: transform 0.4s cubic-bezier(0.25,0.46,0.45,0.94); }
.prod-card:active { transform: scale(0.97); }
.prod-card-img { aspect-ratio: 3/4; position: relative; width: 100%; }
.pi-1,.pi-2,.pi-3,.pi-4,.pi-5,.pi-6 { background: #111009; }
/* Vogue editorial gradient — text floats over image bottom */
.prod-card-img::after { content: ''; position: absolute; inset: 0; background: linear-gradient(to top, rgba(4,2,1,0.97) 0%, rgba(4,2,1,0.6) 28%, rgba(4,2,1,0.1) 52%, transparent 68%); pointer-events: none; }
.prod-tag { position: absolute; top: 10px; left: 10px; padding: 3px 8px; border-radius: 1px; font-size: 8px; letter-spacing: 2px; text-transform: uppercase; font-weight: 500; z-index: 2; }
.tag-new { background: var(--gold); color: var(--ink); }
.tag-exc { background: transparent; color: var(--gold); border: 1px solid rgba(201,169,110,0.7); }
.prod-save { position: absolute; top: 10px; right: 10px; width: 28px; height: 28px; background: rgba(0,0,0,0.3); backdrop-filter: blur(8px); border-radius: 50%; border: 1px solid rgba(255,255,255,0.18); cursor: pointer; font-size: 12px; color: rgba(255,255,255,0.85); display: flex; align-items: center; justify-content: center; z-index: 2; }
/* Info overlaid at bottom of image — no white block below */
.prod-card-info { position: absolute; bottom: 0; left: 0; right: 0; padding: 0 14px 16px; z-index: 2; }
.prod-cat { font-size: 8px; letter-spacing: 2.5px; text-transform: uppercase; color: var(--gold); margin-bottom: 3px; opacity: 0.9; }
.prod-name { font-family: 'Cormorant Garamond', serif; font-size: 18px; font-style: italic; line-height: 1.1; color: rgba(255,255,255,0.95); margin-bottom: 2px; font-weight: 300; letter-spacing: 0.3px; }
.prod-hotel-tag { font-size: 8px; color: rgba(201,169,110,0.7); margin-bottom: 9px; letter-spacing: 2px; text-transform: uppercase; font-weight: 400; }
.prod-foot { display: flex; align-items: center; justify-content: space-between; }
.prod-price { font-family: 'Cormorant Garamond', serif; font-size: 15px; font-weight: 300; color: rgba(201,169,110,0.85); letter-spacing: 0.5px; }
.prod-add { width: 24px; height: 24px; background: transparent; border: 1px solid rgba(201,169,110,0.5); border-radius: 50%; cursor: pointer; font-size: 16px; color: var(--gold); display: flex; align-items: center; justify-content: center; line-height: 1; font-weight: 200; transition: all 0.2s; }

/* ─── SCAN SCREEN ─── */
.step-nav { display: flex; align-items: center; padding: 8px 20px 16px; }
.sdot { width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: 500; border: 1px solid rgba(201,169,110,0.25); color: rgba(245,240,232,0.3); background: transparent; cursor: pointer; flex-shrink: 0; transition: all 0.25s; }
.sdot.active { background: var(--gold); color: var(--ink); border-color: var(--gold); }
.sdot.done { background: var(--gold-dim); color: var(--gold); border-color: var(--gold); }
.sline { flex: 1; height: 1px; background: rgba(201,169,110,0.15); margin: 0 3px; }
.sline.done { background: var(--gold); }
.step-panel { display: none; }
.step-panel.active { display: block; }

.step-head { padding: 0 20px 16px; }
.step-label { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--gold); margin-bottom: 5px; }
.step-title { font-family: 'Cormorant Garamond', serif; font-size: 26px; font-weight: 300; color: var(--cream); line-height: 1.2; margin-bottom: 5px; }
.step-sub { font-size: 12px; color: rgba(245,240,232,0.5); line-height: 1.7; }

.viewfinder { margin: 0 20px; border-radius: 18px; overflow: hidden; position: relative; aspect-ratio: 3/4; background: linear-gradient(145deg, #3D2E1E, #6B4E35, #2E1E10); }
.vf-corner { position: absolute; width: 26px; height: 26px; border-color: var(--gold); border-style: solid; border-width: 0; }
.tl { top: 14px; left: 14px; border-top-width: 2px; border-left-width: 2px; border-radius: 2px 0 0 0; }
.tr { top: 14px; right: 14px; border-top-width: 2px; border-right-width: 2px; border-radius: 0 2px 0 0; }
.bl { bottom: 14px; left: 14px; border-bottom-width: 2px; border-left-width: 2px; border-radius: 0 0 0 2px; }
.br { bottom: 14px; right: 14px; border-bottom-width: 2px; border-right-width: 2px; border-radius: 0 0 2px 0; }
.scan-line { position: absolute; left: 14px; right: 14px; height: 1px; background: linear-gradient(90deg, transparent, var(--gold), transparent); animation: scanDown 2.5s ease-in-out infinite; }
@keyframes scanDown { 0% { top: 14px; opacity: 0; } 10% { opacity: 1; } 90% { opacity: 1; } 100% { top: calc(100% - 14px); opacity: 0; } }
.vf-spot { position: absolute; width: 32px; height: 32px; border: 1.5px solid var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; animation: spotPulse 2s ease-in-out infinite; }
.vf-spot::after { content: ''; width: 8px; height: 8px; background: var(--gold); border-radius: 50%; }
@keyframes spotPulse { 0%, 100% { transform: scale(1); opacity: 0.8; } 50% { transform: scale(1.15); opacity: 1; } }
.ai-spin { animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
@keyframes fadeUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
.fade-up { animation: fadeUp 0.3s ease; }

.cam-btns { display: flex; gap: 10px; margin: 12px 20px 0; }
.cam-btn { flex: 1; padding: 14px; border-radius: 13px; border: none; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 7px; transition: opacity 0.2s; position: relative; overflow: hidden; }
.cam-btn:active { opacity: 0.8; }
.cam-gold { background: var(--gold); color: var(--ink); font-weight: 500; }
.cam-ghost { background: rgba(245,240,232,0.07); border: 1px solid rgba(245,240,232,0.18); color: var(--cream); }
.cam-btn svg { width: 15px; height: 15px; }

.next-btn { display: flex; align-items: center; justify-content: center; gap: 10px; width: calc(100% - 40px); margin: 14px 20px 0; padding: 16px; background: var(--gold); color: var(--ink); border: none; border-radius: 13px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; font-weight: 500; transition: opacity 0.2s; }
.next-btn:active { opacity: 0.85; }
.next-btn svg { width: 15px; height: 15px; }
.back-link { display: block; text-align: center; font-size: 11px; color: rgba(245,240,232,0.35); cursor: pointer; padding: 11px 0; }

.id-img { margin: 0 20px; border-radius: 14px; overflow: hidden; height: 185px; position: relative; background: linear-gradient(145deg, #3D2E1E, #6B4E35); }
.id-badge { position: absolute; top: 12px; left: 12px; background: rgba(22,18,16,0.85); border: 1px solid var(--gold-border); backdrop-filter: blur(8px); padding: 5px 12px; border-radius: 20px; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); }
.id-spot { position: absolute; width: 28px; height: 28px; border: 1.5px solid var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; background: rgba(201,169,110,0.15); cursor: pointer; }
.id-spot::after { content: ''; width: 7px; height: 7px; background: var(--gold); border-radius: 50%; }

.id-list { padding: 14px 20px 0; }
.id-list-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-bottom: 10px; }
.id-item { display: flex; align-items: center; gap: 12px; padding: 11px; background: rgba(245,240,232,0.04); border: 1px solid rgba(201,169,110,0.12); border-radius: 11px; margin-bottom: 8px; cursor: pointer; }
.id-swatch { width: 46px; height: 46px; border-radius: 8px; flex-shrink: 0; }
.sw-1 { background: linear-gradient(135deg, #8B6E52, #6B4E35); }
.sw-2 { background: linear-gradient(135deg, #C4A882, #A08060); }
.sw-3 { background: linear-gradient(135deg, #3D3028, #2A2018); }
.sw-4 { background: linear-gradient(135deg, #2A3D30, #1A2820); }
.id-info { flex: 1; }
.id-name { font-family: 'Cormorant Garamond', serif; font-size: 16px; color: var(--cream); margin-bottom: 2px; }
.id-brand { font-size: 10px; color: var(--muted); margin-bottom: 3px; }
.id-price { font-family: 'Cormorant Garamond', serif; font-size: 14px; color: var(--gold); }
.id-check { width: 22px; height: 22px; border: 1.5px solid rgba(201,169,110,0.35); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; color: transparent; transition: all 0.2s; flex-shrink: 0; }
.id-check.on { background: var(--gold); border-color: var(--gold); color: var(--ink); }

.lfl-orig { margin: 0 20px 12px; background: rgba(245,240,232,0.05); border: 1px solid var(--gold-border); border-radius: 13px; padding: 13px; display: flex; gap: 13px; align-items: center; }
.lfl-orig-img { width: 70px; height: 70px; border-radius: 9px; flex-shrink: 0; }
.lfl-orig-name { font-family: 'Cormorant Garamond', serif; font-size: 17px; color: var(--cream); margin-bottom: 2px; }
.lfl-orig-hotel { font-size: 10px; color: var(--muted); margin-bottom: 4px; }
.lfl-orig-price { font-family: 'Cormorant Garamond', serif; font-size: 18px; color: var(--gold); }
.lfl-section-title { padding: 0 20px; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: rgba(245,240,232,0.4); margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
.lfl-section-title::after { content: ''; flex: 1; height: 1px; background: rgba(245,240,232,0.08); }
.lfl-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; padding: 0 20px; }
.lfl-card { background: rgba(245,240,232,0.04); border: 1px solid rgba(245,240,232,0.08); border-radius: 11px; overflow: hidden; cursor: pointer; transition: border-color 0.2s; }
.lfl-card:active { border-color: var(--gold); }
.lfl-img { height: 90px; }
.lfl-1 { background: linear-gradient(135deg, #E8DDD0, #C4B098); }
.lfl-2 { background: linear-gradient(135deg, #D0C8BC, #B8ACAA); }
.lfl-3 { background: linear-gradient(135deg, #C8C0B4, #ACA498); }
.lfl-4 { background: linear-gradient(135deg, #E0D4C8, #C4B8A8); }
.lfl-info { padding: 9px 10px 11px; }
.lfl-name { font-size: 11px; color: rgba(245,240,232,0.75); margin-bottom: 3px; }
.lfl-price { font-family: 'Cormorant Garamond', serif; font-size: 15px; color: var(--gold); }
.lfl-save { font-size: 9px; color: #7CC87C; margin-top: 2px; }

.ctl-selected { margin: 0 20px 12px; background: rgba(245,240,232,0.05); border: 1px solid var(--gold-border); border-radius: 11px; padding: 11px 13px; display: flex; align-items: center; gap: 11px; }
.ctl-sel-img { width: 42px; height: 42px; border-radius: 7px; flex-shrink: 0; }
.ctl-sel-name { font-size: 12px; color: var(--cream); flex: 1; }
.ctl-sel-price { font-family: 'Cormorant Garamond', serif; font-size: 15px; color: var(--gold); }
.ctl-section { padding: 0 20px; margin-bottom: 16px; }
.ctl-section-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: rgba(245,240,232,0.4); margin-bottom: 9px; }
.ctl-row { display: flex; gap: 9px; overflow-x: auto; scrollbar-width: none; }
.ctl-row::-webkit-scrollbar { display: none; }
.ctl-item { flex-shrink: 0; width: 120px; background: rgba(245,240,232,0.04); border: 1px solid rgba(245,240,232,0.08); border-radius: 11px; overflow: hidden; cursor: pointer; transition: border-color 0.2s; }
.ctl-item.on { border-color: var(--gold); }
.ctl-item-img { height: 82px; }
.ci-1 { background: linear-gradient(135deg, #2A3540, #3D5060); }
.ci-2 { background: linear-gradient(135deg, #3D2820, #6B3D28); }
.ci-3 { background: linear-gradient(135deg, #E0D8CC, #C8BCAC); }
.ci-4 { background: linear-gradient(135deg, #1A1A1A, #2D2D2D); }
.ci-5 { background: linear-gradient(135deg, #1A2820, #2E4535); }
.ci-6 { background: linear-gradient(135deg, #3D3528, #5C5040); }
.ctl-item-body { padding: 7px 9px 9px; }
.ctl-item-name { font-size: 10px; color: rgba(245,240,232,0.65); margin-bottom: 2px; line-height: 1.3; }
.ctl-item-price { font-family: 'Cormorant Garamond', serif; font-size: 13px; color: var(--gold); }
.ctl-item-action { font-size: 8px; letter-spacing: 1px; text-transform: uppercase; color: var(--muted); margin-top: 2px; }
.ctl-item.on .ctl-item-action { color: var(--gold); }

.cart-summary { margin: 0 20px 14px; background: rgba(245,240,232,0.04); border: 1px solid var(--gold-border); border-radius: 13px; padding: 14px; }
.cs-title { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-bottom: 10px; }
.cs-row { display: flex; justify-content: space-between; margin-bottom: 7px; }
.cs-row-name { font-size: 12px; color: rgba(245,240,232,0.6); }
.cs-row-price { font-family: 'Cormorant Garamond', serif; font-size: 13px; color: var(--cream); }
.cs-divider { height: 1px; background: rgba(201,169,110,0.15); margin: 9px 0; }
.cs-total { display: flex; justify-content: space-between; align-items: center; }
.cs-total-label { font-size: 10px; letter-spacing: 1px; text-transform: uppercase; color: var(--muted); }
.cs-total-val { font-family: 'Cormorant Garamond', serif; font-size: 22px; color: var(--gold); }

.co-section { margin-bottom: 16px; padding: 0 20px; }
.co-label { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-bottom: 9px; }
.co-row { display: flex; align-items: center; justify-content: space-between; background: rgba(245,240,232,0.05); border: 1px solid rgba(245,240,232,0.08); border-radius: 11px; padding: 13px 14px; margin-bottom: 7px; cursor: pointer; }
.co-row:active { border-color: var(--gold); }
.co-row-left { display: flex; align-items: center; gap: 11px; }
.co-icon { width: 34px; height: 34px; background: var(--gold-dim); border-radius: 9px; display: flex; align-items: center; justify-content: center; font-size: 15px; }
.co-row-lbl { font-size: 10px; color: rgba(245,240,232,0.4); }
.co-row-val { font-size: 13px; color: var(--cream); }
.co-row-arrow { color: var(--muted); font-size: 18px; }
.co-items { background: rgba(245,240,232,0.03); border: 1px solid rgba(245,240,232,0.07); border-radius: 11px; overflow: hidden; margin-bottom: 7px; }
.co-item { display: flex; gap: 11px; padding: 11px 13px; border-bottom: 1px solid rgba(245,240,232,0.05); align-items: center; }
.co-item:last-child { border-bottom: none; }
.co-item-img { width: 48px; height: 48px; border-radius: 7px; flex-shrink: 0; }
.coi-1 { background: linear-gradient(135deg, #8B6E52, #6B4E35); }
.coi-2 { background: linear-gradient(135deg, #2A3540, #3D5060); }
.coi-3 { background: linear-gradient(135deg, #E0D8CC, #C8BCAC); }
.co-item-name { font-size: 12px; color: var(--cream); margin-bottom: 2px; }
.co-item-hotel { font-size: 10px; color: var(--muted); }
.co-item-price { font-family: 'Cormorant Garamond', serif; font-size: 14px; color: var(--gold); margin-left: auto; flex-shrink: 0; }
.co-totals { background: rgba(245,240,232,0.03); border: 1px solid rgba(245,240,232,0.07); border-radius: 11px; padding: 13px; }
.co-total-row { display: flex; justify-content: space-between; margin-bottom: 7px; }
.co-total-row:last-child { margin-bottom: 0; padding-top: 9px; border-top: 1px solid rgba(245,240,232,0.08); }
.co-total-lbl { font-size: 11px; color: var(--muted); }
.co-total-val { font-size: 12px; color: var(--cream); }
.co-total-row:last-child .co-total-lbl { font-size: 10px; letter-spacing: 1px; text-transform: uppercase; }
.co-total-row:last-child .co-total-val { font-family: 'Cormorant Garamond', serif; font-size: 21px; color: var(--gold); }
.submit-btn { width: 100%; padding: 17px; background: var(--gold); color: var(--ink); border: none; border-radius: 13px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; font-weight: 500; margin-top: 14px; margin-bottom: 5px; transition: opacity 0.2s; }
.submit-btn:active { opacity: 0.85; }
.co-guest { text-align: center; font-size: 11px; color: var(--muted); padding: 4px 0; }
.co-guest span { color: var(--gold); cursor: pointer; }

.success-wrap { display: flex; flex-direction: column; align-items: center; padding: 48px 28px; text-align: center; }
.success-icon { width: 70px; height: 70px; background: var(--gold-dim); border: 2px solid var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 26px; margin-bottom: 22px; }
.success-title { font-family: 'Cormorant Garamond', serif; font-size: 32px; font-weight: 300; color: var(--cream); margin-bottom: 9px; }
.success-sub { font-size: 12px; color: rgba(245,240,232,0.5); line-height: 1.8; margin-bottom: 26px; }
.success-order-label { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--gold); margin-bottom: 4px; }
.success-order-num { font-family: 'Cormorant Garamond', serif; font-size: 22px; color: var(--cream); margin-bottom: 28px; }

/* ─── MOODBOARD SCREEN ─── */
.mb-intro { padding: 0 20px 18px; }
.mb-eyebrow { font-size: 10px; letter-spacing: 3px; text-transform: uppercase; color: var(--gold); margin-bottom: 6px; }
.mb-title { font-family: 'Cormorant Garamond', serif; font-size: 26px; font-weight: 300; color: var(--cream); line-height: 1.2; margin-bottom: 8px; }
.mb-sub { font-size: 12px; color: rgba(245,240,232,0.5); line-height: 1.7; }
.upload-zone { margin: 0 20px 16px; border: 1.5px dashed rgba(201,169,110,0.4); border-radius: 18px; padding: 30px 22px; display: flex; flex-direction: column; align-items: center; gap: 11px; cursor: pointer; background: rgba(245,240,232,0.03); text-align: center; }
.upload-zone:active { border-color: var(--gold); }
.upload-icon-wrap { width: 50px; height: 50px; border-radius: 50%; background: var(--gold-dim); border: 1px solid var(--gold-border); display: flex; align-items: center; justify-content: center; font-size: 22px; }
.upload-title { font-family: 'Cormorant Garamond', serif; font-size: 18px; color: var(--cream); }
.upload-sub { font-size: 11px; color: rgba(245,240,232,0.4); line-height: 1.6; }
.upload-btns { display: flex; gap: 10px; margin: 0 20px 16px; }
.upload-btn { flex: 1; padding: 13px; border-radius: 13px; border: none; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; display: flex; align-items: center; justify-content: center; gap: 7px; transition: opacity 0.2s; }
.upload-btn:active { opacity: 0.8; }
.upload-btn-gold { background: var(--gold); color: var(--ink); font-weight: 500; }
.upload-btn-ghost { background: rgba(245,240,232,0.07); border: 1px solid rgba(245,240,232,0.15); color: var(--cream); }
.room-preview-wrap { margin: 0 20px 14px; border-radius: 15px; overflow: hidden; aspect-ratio: 4/3; position: relative; display: none; }
.room-preview-wrap img { width: 100%; height: 100%; object-fit: cover; }
.room-label { position: absolute; top: 11px; left: 11px; background: rgba(22,18,16,0.85); backdrop-filter: blur(8px); border: 1px solid var(--gold-border); padding: 4px 11px; border-radius: 20px; font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); }
.room-pin { position: absolute; width: 28px; height: 28px; border: 1.5px solid var(--gold); border-radius: 50%; background: rgba(201,169,110,0.2); display: flex; align-items: center; justify-content: center; cursor: pointer; animation: spotPulse 2s ease-in-out infinite; }
.room-pin::after { content: ''; width: 7px; height: 7px; background: var(--gold); border-radius: 50%; }
.ai-gen { margin: 0 20px; display: none; flex-direction: column; align-items: center; gap: 14px; padding: 30px; background: rgba(245,240,232,0.03); border: 1px solid var(--gold-border); border-radius: 18px; text-align: center; }
.ai-spinner { width: 46px; height: 46px; border-radius: 50%; border: 2px solid var(--gold-dim); border-top-color: var(--gold); }
.ai-gen-title { font-family: 'Cormorant Garamond', serif; font-size: 19px; color: var(--cream); }
.ai-gen-sub { font-size: 11px; color: rgba(245,240,232,0.4); line-height: 1.6; }
.mb-result { display: none; padding: 0 20px; }
.mb-result-title { font-family: 'Cormorant Garamond', serif; font-size: 20px; color: var(--cream); margin-bottom: 3px; }
.mb-result-sub { font-size: 11px; color: rgba(245,240,232,0.45); margin-bottom: 14px; line-height: 1.6; }
.mb-ai-card { background: rgba(245,240,232,0.04); border: 1px solid var(--gold-border); border-radius: 14px; padding: 16px; margin-bottom: 14px; }
.mb-ai-eyebrow { font-size: 9px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-bottom: 8px; }
.mb-ai-quote { font-family: 'Cormorant Garamond', serif; font-style: italic; font-size: 14px; color: rgba(245,240,232,0.75); line-height: 1.8; }
.mb-placement { display: flex; gap: 11px; align-items: flex-start; background: rgba(245,240,232,0.04); border: 1px solid rgba(245,240,232,0.07); border-radius: 11px; padding: 11px; margin-bottom: 8px; }
.mb-placement-img { width: 50px; height: 50px; border-radius: 7px; flex-shrink: 0; }
.mbi-1 { background: linear-gradient(135deg, #8B6E52, #6B4E35); }
.mbi-2 { background: linear-gradient(135deg, #2A3540, #3D5060); }
.mbi-3 { background: linear-gradient(135deg, #E0D8CC, #C8BCAC); }
.mb-placement-name { font-family: 'Cormorant Garamond', serif; font-size: 15px; color: var(--cream); margin-bottom: 3px; }
.mb-placement-tip { font-size: 11px; color: rgba(245,240,232,0.5); line-height: 1.5; margin-bottom: 3px; }
.mb-placement-pos { font-size: 10px; color: var(--gold); }
.mb-regen { width: 100%; padding: 13px; background: var(--gold-dim); border: 1px solid var(--gold-border); border-radius: 13px; color: var(--gold); cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 8px; transition: opacity 0.2s; }
.mb-regen:active { opacity: 0.8; }

/* ─── HOTELS SCREEN ─── */
.hotel-card { margin: 0 16px 12px; border-radius: 16px; overflow: hidden; height: 190px; position: relative; cursor: pointer; }
.hotel-card:active { opacity: 0.92; }
.hc-1 { background: linear-gradient(135deg, #2C2018, #4A3525, #1E1410); }
.hc-2 { background: linear-gradient(135deg, #1E2D33, #3D5058, #1A2830); }
.hc-3 { background: linear-gradient(135deg, #2A2A2A, #3D3D3D); }
.hc-4 { background: linear-gradient(135deg, #1A2820, #2E4535, #152018); }
.hc-5 { background: linear-gradient(135deg, #2A2820, #4A3D2E, #231E18); }
.hotel-card::before { content: ''; position: absolute; inset: 0; background: radial-gradient(ellipse at 35% 30%, rgba(201,169,110,0.14) 0%, transparent 60%); }
.hc-overlay { position: absolute; inset: 0; background: linear-gradient(to top, rgba(16,10,6,0.9) 0%, transparent 55%); padding: 16px; display: flex; flex-direction: column; justify-content: flex-end; }
.hc-badge { position: absolute; top: 13px; left: 13px; background: var(--gold); color: var(--ink); font-size: 8px; letter-spacing: 2px; text-transform: uppercase; padding: 3px 9px; border-radius: 4px; font-weight: 500; }
.hc-name { font-family: 'Cormorant Garamond', serif; font-size: 21px; font-weight: 300; color: var(--cream); margin-bottom: 3px; }
.hc-loc { font-size: 10px; color: rgba(245,240,232,0.6); margin-bottom: 9px; }
.hc-foot { display: flex; align-items: center; justify-content: space-between; }
.hc-count { font-size: 11px; color: var(--gold-lt); }
.hc-arrow { width: 28px; height: 28px; background: rgba(245,240,232,0.1); border: 1px solid rgba(245,240,232,0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--cream); font-size: 14px; }

/* ─── WISHLIST SCREEN ─── */
.wl-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 2px; padding: 0 16px; }
.wl-card { border-radius: 12px; overflow: hidden; background: white; cursor: pointer; position: relative; }
.wl-img { aspect-ratio: 1; }
.wl-1,.wl-2,.wl-3,.wl-4 { background: #111009; }
.wl-rm { position: absolute; top: 8px; right: 8px; width: 24px; height: 24px; background: rgba(255,255,255,0.9); border-radius: 50%; border: none; cursor: pointer; font-size: 12px; display: flex; align-items: center; justify-content: center; }
.wl-info { padding: 9px 11px 11px; }
.wl-name { font-family: 'Cormorant Garamond', serif; font-size: 15px; color: var(--ink); margin-bottom: 3px; }
.wl-price { font-size: 13px; color: var(--gold); }

/* ─── PROFILE SCREEN ─── */
.profile-hero { margin: 0 16px 14px; background: linear-gradient(135deg, var(--ink), #2A2018); border: 1px solid var(--gold-border); border-radius: 18px; padding: 22px; display: flex; align-items: center; gap: 14px; }
.profile-avatar { width: 56px; height: 56px; border-radius: 50%; background: linear-gradient(135deg, var(--gold), var(--gold-lt)); display: flex; align-items: center; justify-content: center; font-family: 'Cormorant Garamond', serif; font-size: 22px; color: var(--ink); font-weight: 400; }
.profile-name { font-family: 'Cormorant Garamond', serif; font-size: 21px; color: var(--cream); font-weight: 300; }
.profile-member { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-top: 2px; }
.profile-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; margin: 0 16px 14px; }
.profile-stat { background: white; padding: 14px 11px; text-align: center; border-radius: 10px; }
.ps-num { font-family: 'Cormorant Garamond', serif; font-size: 26px; font-weight: 300; color: var(--gold); }
.ps-label { font-size: 9px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--muted); margin-top: 2px; }
.profile-menu { display: flex; flex-direction: column; gap: 2px; margin: 0 16px; }
.profile-item { display: flex; align-items: center; justify-content: space-between; background: white; padding: 13px 15px; border-radius: 11px; cursor: pointer; }
.profile-item:active { background: var(--cream); }
.pi-left { display: flex; align-items: center; gap: 13px; }
.pi-icon { width: 34px; height: 34px; border-radius: 9px; background: var(--cream); display: flex; align-items: center; justify-content: center; font-size: 15px; }
.pi-label { font-size: 14px; font-weight: 400; color: var(--ink); }
.pi-arrow { color: var(--muted); font-size: 18px; }

/* ─── PRODUCT SHEET ─── */
.sheet-img-wrap { width: calc(100% - 32px); margin: 0 16px; border-radius: 15px; overflow: hidden; aspect-ratio: 4/3; }
.sheet-body { padding: 16px 19px 4px; }
.sheet-hotel-tag { display: inline-flex; align-items: center; gap: 6px; background: rgba(201,169,110,0.1); border: 1px solid rgba(201,169,110,0.25); padding: 4px 11px; border-radius: 20px; font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--gold); margin-bottom: 9px; }
.sheet-prod-name { font-family: 'Cormorant Garamond', serif; font-size: 25px; font-weight: 300; line-height: 1.1; color: var(--ink); margin-bottom: 4px; }
.sheet-prod-cat { font-size: 11px; color: var(--muted); margin-bottom: 12px; }
.sheet-prod-price { font-family: 'Cormorant Garamond', serif; font-size: 28px; font-weight: 300; color: var(--gold); margin-bottom: 12px; }
.sheet-prod-desc { font-size: 13px; line-height: 1.8; color: var(--muted); margin-bottom: 18px; }
.sheet-divider { height: 1px; background: var(--div); margin-bottom: 18px; }
.sheet-details { display: grid; grid-template-columns: 1fr 1fr; gap: 9px; margin-bottom: 18px; }
.sheet-detail { background: var(--cream); padding: 11px; border-radius: 9px; }
.detail-label { font-size: 9px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--muted); margin-bottom: 3px; }
.detail-val { font-size: 13px; font-weight: 400; color: var(--ink); }
.sheet-lfl-title { font-size: 10px; letter-spacing: 2px; text-transform: uppercase; color: var(--gold); margin-bottom: 11px; padding: 0 19px; }
.sheet-lfl-row { display: flex; gap: 9px; overflow-x: auto; padding: 0 19px 4px; scrollbar-width: none; }
.sheet-lfl-row::-webkit-scrollbar { display: none; }
.slfl-card { flex-shrink: 0; width: 100px; background: var(--cream); border-radius: 9px; overflow: hidden; cursor: pointer; border: 1px solid var(--div); }
.slfl-card:active { border-color: var(--gold); }
.slfl-img { height: 74px; }
.slfl-i1 { background: linear-gradient(135deg, #E8DDD0, #C4B098); }
.slfl-i2 { background: linear-gradient(135deg, #D8D0C4, #C0B4A8); }
.slfl-i3 { background: linear-gradient(135deg, #C8C0B4, #B0A898); }
.slfl-body { padding: 7px 8px; }
.slfl-price { font-family: 'Cormorant Garamond', serif; font-size: 14px; color: var(--ink); }
.slfl-save { font-size: 9px; color: #2E7D32; font-weight: 500; }
.sheet-actions { display: flex; gap: 9px; padding: 0 19px 20px; position: sticky; bottom: 0; background: #FAF7F2; }
.sheet-save-btn { width: 46px; height: 50px; border: 1.5px solid var(--div); border-radius: 11px; background: none; cursor: pointer; font-size: 19px; display: flex; align-items: center; justify-content: center; }
.sheet-room-btn { flex: 1; height: 50px; background: var(--gold-dim); color: var(--gold); border: 1.5px solid var(--gold-border); border-radius: 11px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 10px; letter-spacing: 1.5px; text-transform: uppercase; }
.sheet-add-btn { flex: 1; height: 50px; background: var(--ink); color: var(--cream); border: none; border-radius: 11px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; }
.sheet-add-btn:active { background: var(--gold); color: var(--ink); }

/* ─── CART SHEET ─── */
.cart-head { display: flex; align-items: center; justify-content: space-between; padding: 4px 19px 13px; border-bottom: 1px solid rgba(245,240,232,0.07); }
.cart-title { font-family: 'Cormorant Garamond', serif; font-size: 21px; font-weight: 300; color: var(--cream); }
.cart-close { background: rgba(245,240,232,0.08); border-radius: 50%; width: 30px; height: 30px; border: none; cursor: pointer; font-size: 16px; color: var(--muted); display: flex; align-items: center; justify-content: center; }
.cart-items { overflow-y: auto; max-height: 38vh; padding: 0 19px; }
.cart-item { display: flex; gap: 13px; padding: 13px 0; border-bottom: 1px solid rgba(245,240,232,0.06); align-items: center; }
.cart-item-img { width: 66px; height: 66px; border-radius: 9px; flex-shrink: 0; }
.cii-1 { background: linear-gradient(135deg, #8B6E52, #6B4E35); }
.cii-2 { background: linear-gradient(135deg, #2A3540, #3D5060); }
.cii-3 { background: linear-gradient(135deg, #3D2820, #6B3D28); }
.cart-item-name { font-family: 'Cormorant Garamond', serif; font-size: 16px; color: var(--cream); margin-bottom: 2px; }
.cart-item-hotel { font-size: 10px; color: var(--muted); margin-bottom: 4px; }
.cart-item-price { font-family: 'Cormorant Garamond', serif; font-size: 14px; color: var(--gold); }
.cart-rm { background: none; border: none; color: var(--muted); font-size: 20px; cursor: pointer; padding: 4px; margin-left: auto; flex-shrink: 0; }
.cart-foot { padding: 13px 19px; border-top: 1px solid rgba(245,240,232,0.07); }
.cart-total-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 13px; }
.cart-total-label { font-size: 11px; letter-spacing: 1.5px; text-transform: uppercase; color: var(--muted); }
.cart-total-amount { font-family: 'Cormorant Garamond', serif; font-size: 25px; color: var(--gold); }
.cart-checkout-btn { width: 100%; height: 50px; background: var(--gold); color: var(--ink); border: none; border-radius: 13px; cursor: pointer; font-family: 'DM Sans', sans-serif; font-size: 11px; letter-spacing: 2px; text-transform: uppercase; font-weight: 500; }
.cart-checkout-btn:active { opacity: 0.85; }
</style>
</head>
<body>
<div id="app">

<!-- ════════════════════════
     DISCOVER
════════════════════════ -->
<div class="screen screen-light active" id="s-home">
  <div class="sb"></div>
  <div class="topbar topbar-light">
    <div class="logo logo-dark">Hand <span>Selected</span></div>
    <div class="top-btns">
      <button class="ibtn ibtn-dark" onclick="toast('Search coming soon')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
      </button>
      <button class="ibtn ibtn-dark" onclick="openCart()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" y1="6" x2="21" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>
        <span class="badge" id="cartBadge">3</span>
      </button>
    </div>
  </div>

  <div class="hero" onclick="goTo('s-hotels', 'tab-hotels')" style="margin-bottom:14px;background-image:url('https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?w=1200&q=80');background-size:cover;background-position:center;">
    <div class="hero-overlay">
      <div class="hero-pill">✦ Exclusive Partner</div>
      <h2>Mondrian<br>London</h2>
      <div class="hero-sub">38 curated pieces available</div>
      <div class="hero-cta"><span>Shop This Hotel</span><span>→</span></div>
    </div>
  </div>

  <div class="sec-head" style="margin-bottom:12px;">
    <div class="sec-title">Partner Hotels</div>
    <button class="sec-more" onclick="goTo('s-hotels','tab-hotels')">See All</button>
  </div>
  <div class="hscroll" style="margin-bottom:22px;">
    <div class="hotel-pill" onclick="goTo('s-hotels','tab-hotels')"><div class="hotel-pill-img hi-1" style="background-image:url('https://images.unsplash.com/photo-1578683010236-d716f9a3f461?w=400&q=80');background-size:cover;background-position:center;"></div><div class="hotel-pill-info"><div class="hotel-pill-name">The Standard</div><div class="hotel-pill-loc">London · 29 items</div></div></div>
    <div class="hotel-pill" onclick="goTo('s-hotels','tab-hotels')"><div class="hotel-pill-img hi-2" style="background-image:url('https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=400&q=80');background-size:cover;background-position:center;"></div><div class="hotel-pill-info"><div class="hotel-pill-name">25hours Vienna</div><div class="hotel-pill-loc">Vienna · 34 items</div></div></div>
    <div class="hotel-pill" onclick="goTo('s-hotels','tab-hotels')"><div class="hotel-pill-img hi-3" style="background-image:url('https://images.unsplash.com/photo-1564501049412-61c2a3083791?w=400&q=80');background-size:cover;background-position:center;"></div><div class="hotel-pill-info"><div class="hotel-pill-name">W Amsterdam</div><div class="hotel-pill-loc">Amsterdam · 41 items</div></div></div>
    <div class="hotel-pill" onclick="goTo('s-hotels','tab-hotels')"><div class="hotel-pill-img hi-4" style="background-image:url('https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?w=400&q=80');background-size:cover;background-position:center;"></div><div class="hotel-pill-info"><div class="hotel-pill-name">SLS Barcelona</div><div class="hotel-pill-loc">Barcelona · 27 items</div></div></div>
    <div class="hotel-pill" onclick="goTo('s-hotels','tab-hotels')"><div class="hotel-pill-img hi-5" style="background-image:url('https://images.unsplash.com/photo-1551632436-cbf8dd35adfa?w=400&q=80');background-size:cover;background-position:center;"></div><div class="hotel-pill-info"><div class="hotel-pill-name">Edition Paris</div><div class="hotel-pill-loc">Paris · 33 items</div></div></div>
  </div>

  <div class="chips" style="margin-bottom:18px;">
    <div class="chip active" onclick="filterChip(this,'All')">All</div>
    <div class="chip" onclick="filterChip(this,'Furniture')">Furniture</div>
    <div class="chip" onclick="filterChip(this,'Lighting')">Lighting</div>
    <div class="chip" onclick="filterChip(this,'Linens')">Linens</div>
    <div class="chip" onclick="filterChip(this,'Accessories')">Accessories</div>
    <div class="chip" onclick="filterChip(this,'Candles')">Candles</div>
  </div>

  <div class="sec-head" style="margin-bottom:10px;">
    <div class="sec-title">New Arrivals</div>
    <button class="sec-more">View All</button>
  </div>
  <div class="prod-grid">
    <div class="prod-card" onclick="openSheet('Linen Armchair','$2,400','Mondrian London','Furniture','Handcrafted Belgian linen armchair from the Mondrian London suites. Solid walnut frame, hand-finished.','pi-1')">
      <div class="prod-card-img pi-1" style="background-image:url('https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><span class="prod-tag tag-new">New</span><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Furniture</div><div class="prod-name">Linen Armchair</div><div class="prod-hotel-tag">Mondrian LDN</div><div class="prod-foot"><span class="prod-price">$2,400</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
    <div class="prod-card" onclick="openSheet('Brass Table Lamp','$890','The Standard London','Lighting','Handcrafted brushed brass lamp from The Standard London suites with Como linen shade.','pi-2')">
      <div class="prod-card-img pi-2" style="background-image:url('https://images.unsplash.com/photo-1540932239986-30128078f3c5?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><span class="prod-tag tag-exc">Exclusive</span><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Lighting</div><div class="prod-name">Brass Table Lamp</div><div class="prod-hotel-tag">The Standard London</div><div class="prod-foot"><span class="prod-price">$890</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
    <div class="prod-card" onclick="openSheet('Linen Bedding Set','$480','25hours Vienna','Linens','600-thread count Egyptian cotton, monogrammed with the 25hours Vienna signature embroidery.','pi-3')">
      <div class="prod-card-img pi-3" style="background-image:url('https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Linens</div><div class="prod-name">Linen Bedding Set</div><div class="prod-hotel-tag">25hours Vienna</div><div class="prod-foot"><span class="prod-price">$480</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
    <div class="prod-card" onclick="openSheet('Marble Console','$4,200','W Amsterdam','Furniture','Hand-crafted travertine console from the W Amsterdam heritage suites.','pi-4')">
      <div class="prod-card-img pi-4" style="background-image:url('https://images.unsplash.com/photo-1618221118493-9cfa1a1191cf?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><span class="prod-tag tag-exc">Exclusive</span><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Furniture</div><div class="prod-name">Marble Console</div><div class="prod-hotel-tag">W Amsterdam</div><div class="prod-foot"><span class="prod-price">$4,200</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
    <div class="prod-card" onclick="openSheet('Amber Candle','$95','Mondrian London','Candles','The signature scent of Mondrian London — amber, sandalwood, and tonka bean.','pi-5')">
      <div class="prod-card-img pi-5" style="background-image:url('https://images.unsplash.com/photo-1608181831718-c9fca6c938e6?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><span class="prod-tag tag-new">New</span><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Candles</div><div class="prod-name">Amber Candle</div><div class="prod-hotel-tag">Mondrian LDN</div><div class="prod-foot"><span class="prod-price">$95</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
    <div class="prod-card" onclick="openSheet('Woven Throw','$320','SLS Barcelona','Linens','Organic cotton throw woven by artisans in Portugal. Featured in all SLS Barcelona suites.','pi-6')">
      <div class="prod-card-img pi-6" style="background-image:url('https://images.unsplash.com/photo-1580502304784-8985b7eb7260?w=700&q=95');background-size:cover;background-position:center;background-color:#111009;"><button class="prod-save" onclick="event.stopPropagation();saveItem()">♡</button></div>
      <div class="prod-card-info"><div class="prod-cat">Linens</div><div class="prod-name">Woven Throw</div><div class="prod-hotel-tag">SLS Barcelona</div><div class="prod-foot"><span class="prod-price">$320</span><button class="prod-add" onclick="event.stopPropagation();addToCart()">+</button></div></div></div>
  </div>
</div>

<!-- ════════════════════════
     SCAN — 5 STEPS
════════════════════════ -->
<div class="screen screen-dark" id="s-scan">
  <div class="sb"></div>
  <div class="topbar topbar-dark">
    <div class="logo logo-light">Photo <span>Scan</span></div>
    <button class="ibtn ibtn-light" onclick="toast('Point at any hotel room')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
    </button>
  </div>
  <div class="step-nav" id="stepNav">
    <div class="sdot active" id="sd1">1</div><div class="sline" id="sl1"></div>
    <div class="sdot" id="sd2">2</div><div class="sline" id="sl2"></div>
    <div class="sdot" id="sd3">3</div><div class="sline" id="sl3"></div>
    <div class="sdot" id="sd4">4</div><div class="sline" id="sl4"></div>
    <div class="sdot" id="sd5">5</div>
  </div>

  <!-- Step 1 -->
  <div class="step-panel active fade-up" id="sp1">
    <div class="step-head">
      <div class="step-label">Step 1 of 5</div>
      <div class="step-title">Take a Photo</div>
      <div class="step-sub">Point at any hotel room. Our AI identifies every piece in seconds.</div>
    </div>

    <!-- LIVE CAMERA VIEWFINDER -->
    <div style="margin:0 20px;border-radius:18px;overflow:hidden;position:relative;aspect-ratio:3/4;background:#000;" id="cameraWrap">
      <!-- Live video stream -->
      <video id="cameraFeed" autoplay playsinline muted style="width:100%;height:100%;object-fit:cover;display:block;"></video>
      <!-- Frozen snapshot shown after capture -->
      <canvas id="cameraCanvas" style="position:absolute;inset:0;width:100%;height:100%;display:none;"></canvas>
      <!-- Corner brackets -->
      <div class="vf-corner tl"></div><div class="vf-corner tr"></div><div class="vf-corner bl"></div><div class="vf-corner br"></div>
      <!-- Scan line animation -->
      <div class="scan-line" id="scanLineEl"></div>
      <!-- Camera permission denied message -->
      <div id="camDenied" style="display:none;position:absolute;inset:0;display:none;flex-direction:column;align-items:center;justify-content:center;gap:12px;padding:24px;text-align:center;">
        <div style="font-size:32px;">📷</div>
        <div style="font-family:'Cormorant Garamond',serif;font-size:18px;color:var(--cream);">Camera access needed</div>
        <div style="font-size:11px;color:rgba(245,240,232,0.5);line-height:1.6;">Allow camera access in your browser settings, or use Upload Photo below.</div>
      </div>
      <!-- Analyzing overlay shown on top of frozen frame -->
      <div id="scanAnalyzing" style="display:none;position:absolute;inset:0;background:rgba(22,18,16,0.82);flex-direction:column;align-items:center;justify-content:center;gap:14px;text-align:center;padding:24px;">
        <div style="width:46px;height:46px;border-radius:50%;border:2px solid rgba(201,169,110,0.2);border-top-color:var(--gold);animation:spin 1s linear infinite;flex-shrink:0;"></div>
        <div style="font-family:'Cormorant Garamond',serif;font-size:20px;color:var(--cream);">Identifying items...</div>
        <div style="font-size:11px;color:rgba(245,240,232,0.5);line-height:1.6;">AI is analyzing your photo and matching hotel products.</div>
      </div>
    </div>

    <!-- BUTTONS -->
    <div class="cam-btns">
      <button class="cam-btn cam-gold" id="captureBtn" onclick="capturePhoto()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="4"/></svg>
        Capture
      </button>
      <label class="cam-btn cam-ghost" style="cursor:pointer;position:relative;overflow:hidden;">
        <input type="file" accept="image/*" style="position:absolute;inset:0;width:100%;height:100%;opacity:0;cursor:pointer;" onchange="handleScanUpload(event)">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
        Upload
      </label>
    </div>
    <div style="text-align:center;margin-top:8px;">
      <button onclick="switchCamera()" style="background:none;border:none;color:rgba(245,240,232,0.35);font-size:11px;cursor:pointer;letter-spacing:1px;">⟳ Switch Camera</button>
    </div>
  </div>

  <!-- Step 2 -->
  <div class="step-panel" id="sp2">
    <div class="step-head">
      <div class="step-label">Step 2 of 5</div>
      <div class="step-title">Items Identified</div>
      <div class="step-sub">Hand Selected found 3 products, their brands, and pricing.</div>
    </div>
    <div class="id-img" id="scanPreviewBox" style="position:relative;overflow:hidden;">
      <img id="scanPreviewImg" style="width:100%;height:100%;object-fit:cover;display:none;" src="" alt="Scanned room">
      <div id="scanBadge" class="id-badge">3 Items Found</div>
      <div class="id-spot" style="top:28%;left:20%;"></div>
      <div class="id-spot" style="top:18%;right:24%;"></div>
      <div class="id-spot" style="bottom:28%;left:50%;"></div>
    </div>
    <div class="id-list">
      <div class="id-list-label">Select items to shop</div>
      <div id="identifiedItemsList">
        <!-- Populated dynamically by AI scan -->
        <div class="id-item" onclick="toggleCheck(this)">
          <div class="id-swatch sw-1" style="background-image:url('https://images.unsplash.com/photo-1567538096630-e0c55bd6374c?w=700&q=90');background-size:cover;background-position:center;"></div>
          <div class="id-info"><div class="id-name">Caristo Armchair</div><div class="id-brand">ART LAB · Mondrian LDN</div><div class="id-price">$750</div></div>
          <div class="id-check on">✓</div>
        </div>
        <div class="id-item" onclick="toggleCheck(this)">
          <div class="id-swatch sw-2" style="background-image:url('https://images.unsplash.com/photo-1513506003901-1e6a35549a2d?w=700&q=90');background-size:cover;background-position:center;"></div>
          <div class="id-info"><div class="id-name">Brass Floor Lamp</div><div class="id-brand">Porta Romana · Standard LDN</div><div class="id-price">$1,200</div></div>
          <div class="id-check on">✓</div>
        </div>
        <div class="id-item" onclick="toggleCheck(this)">
          <div class="id-swatch sw-3" style="background-image:url('https://images.unsplash.com/photo-1538688525198-9b88f6f53126?w=700&q=90');background-size:cover;background-position:center;"></div>
          <div class="id-info"><div class="id-name">Walnut Side Table</div><div class="id-brand">Vitra · 25hours Vienna</div><div class="id-price">$980</div></div>
          <div class="id-check">✓</div>
        </div>
      </div>
    </div>
    <button class="next-btn" onclick="gotoStep(3)">Compare Looks for Less <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg></button>
    <span class="back-link" onclick="gotoStep(1)">← Retake Photo</span>
  </div>

  <!-- Step 3 -->
  <div class="step-panel" id="sp3">
    <div class="step-head">
      <div class="step-label">Step 3 of 5</div>
      <div class="step-title">Looks for Less</div>
      <div class="step-sub">Similar styles at lower price points. Choose the original or a budget alternative.</div>
    </div>
    <div class="lfl-orig">
      <div class="lfl-orig-img sw-1"></div>
      <div><div class="lfl-orig-name">Caristo Armchair</div><div class="lfl-orig-hotel">ART LAB · Original</div><div class="lfl-orig-price">$750</div></div>
    </div>
    <div class="lfl-section-title">Similar Styles</div>
    <div class="lfl-grid">
      <div class="lfl-card" onclick="addToCart();toast('Bergen Chair added')"><div class="lfl-img lfl-1"></div><div class="lfl-info"><div class="lfl-name">Bergen Chair</div><div class="lfl-price">$399</div><div class="lfl-save">Save $351</div></div></div>
      <div class="lfl-card" onclick="addToCart();toast('Oslo Lounge added')"><div class="lfl-img lfl-2"></div><div class="lfl-info"><div class="lfl-name">Oslo Lounge</div><div class="lfl-price">$249</div><div class="lfl-save">Save $501</div></div></div>
      <div class="lfl-card" onclick="addToCart();toast('Linen Wing added')"><div class="lfl-img lfl-3"></div><div class="lfl-info"><div class="lfl-name">Linen Wing</div><div class="lfl-price">$480</div><div class="lfl-save">Save $270</div></div></div>
      <div class="lfl-card" onclick="addToCart();toast('Nordic Rest added')"><div class="lfl-img lfl-4"></div><div class="lfl-info"><div class="lfl-name">Nordic Rest</div><div class="lfl-price">$600</div><div class="lfl-save">Save $150</div></div></div>
    </div>
    <button class="next-btn" onclick="gotoStep(4)">Complete the Look <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg></button>
    <span class="back-link" onclick="gotoStep(2)">← Back</span>
  </div>

  <!-- Step 4 -->
  <div class="step-panel" id="sp4">
    <div class="step-head">
      <div class="step-label">Step 4 of 5</div>
      <div class="step-title">Complete the Look</div>
      <div class="step-sub">Curated additions to finish your space from the same hotel aesthetic.</div>
    </div>
    <div class="ctl-selected">
      <div class="ctl-sel-img sw-1"></div>
      <div class="ctl-sel-name">Caristo Armchair (selected)</div>
      <div class="ctl-sel-price">$750</div>
    </div>
    <div class="ctl-section">
      <div class="ctl-section-label">Lighting</div>
      <div class="ctl-row">
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-1"></div><div class="ctl-item-body"><div class="ctl-item-name">Arch Floor Lamp</div><div class="ctl-item-price">$250</div><div class="ctl-item-action">+ Add</div></div></div>
        <div class="ctl-item on" onclick="toggleCtl(this)"><div class="ctl-item-img ci-2"></div><div class="ctl-item-body"><div class="ctl-item-name">Brass Table Lamp</div><div class="ctl-item-price">$890</div><div class="ctl-item-action">✓ Added</div></div></div>
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-1"></div><div class="ctl-item-body"><div class="ctl-item-name">Sconce Pair</div><div class="ctl-item-price">$320</div><div class="ctl-item-action">+ Add</div></div></div>
      </div>
    </div>
    <div class="ctl-section">
      <div class="ctl-section-label">Tables & Storage</div>
      <div class="ctl-row">
        <div class="ctl-item on" onclick="toggleCtl(this)"><div class="ctl-item-img ci-3"></div><div class="ctl-item-body"><div class="ctl-item-name">Walnut Side Table</div><div class="ctl-item-price">$299</div><div class="ctl-item-action">✓ Added</div></div></div>
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-4"></div><div class="ctl-item-body"><div class="ctl-item-name">Bookcase Unit</div><div class="ctl-item-price">$800</div><div class="ctl-item-action">+ Add</div></div></div>
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-5"></div><div class="ctl-item-body"><div class="ctl-item-name">Console Table</div><div class="ctl-item-price">$549</div><div class="ctl-item-action">+ Add</div></div></div>
      </div>
    </div>
    <div class="ctl-section">
      <div class="ctl-section-label">Textiles & Scent</div>
      <div class="ctl-row">
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-6"></div><div class="ctl-item-body"><div class="ctl-item-name">Woven Throw</div><div class="ctl-item-price">$140</div><div class="ctl-item-action">+ Add</div></div></div>
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-2"></div><div class="ctl-item-body"><div class="ctl-item-name">Amber Candle</div><div class="ctl-item-price">$95</div><div class="ctl-item-action">+ Add</div></div></div>
        <div class="ctl-item" onclick="toggleCtl(this)"><div class="ctl-item-img ci-3"></div><div class="ctl-item-body"><div class="ctl-item-name">Ceramic Vase</div><div class="ctl-item-price">$180</div><div class="ctl-item-action">+ Add</div></div></div>
      </div>
    </div>
    <div class="cart-summary">
      <div class="cs-title">Your Selection</div>
      <div class="cs-row"><span class="cs-row-name">Caristo Armchair</span><span class="cs-row-price">$750</span></div>
      <div class="cs-row"><span class="cs-row-name">Brass Table Lamp</span><span class="cs-row-price">$890</span></div>
      <div class="cs-row"><span class="cs-row-name">Walnut Side Table</span><span class="cs-row-price">$299</span></div>
      <div class="cs-divider"></div>
      <div class="cs-total"><span class="cs-total-label">Total</span><span class="cs-total-val">$1,939</span></div>
    </div>
    <button class="next-btn" onclick="gotoStep(5)">Proceed to Checkout <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg></button>
    <span class="back-link" onclick="gotoStep(3)">← Back</span>
  </div>

  <!-- Step 5 -->
  <div class="step-panel" id="sp5">
    <div class="step-head">
      <div class="step-label">Step 5 of 5</div>
      <div class="step-title">Checkout</div>
      <div class="step-sub">Review your order and complete your purchase securely.</div>
    </div>
    <div class="co-section">
      <div class="co-label">Shipping</div>
      <div class="co-row" onclick="toast('Add shipping address')"><div class="co-row-left"><div class="co-icon">🏠</div><div><div class="co-row-lbl">Deliver to</div><div class="co-row-val">Add shipping address</div></div></div><span class="co-row-arrow">›</span></div>
    </div>
    <div class="co-section">
      <div class="co-label">Payment</div>
      <div class="co-row" onclick="toast('Add payment method')"><div class="co-row-left"><div class="co-icon">💳</div><div><div class="co-row-lbl">Pay with</div><div class="co-row-val">Add payment method</div></div></div><span class="co-row-arrow">›</span></div>
      <div class="co-row" onclick="toast('American Express — preferred partner ✦')"><div class="co-row-left"><div class="co-icon">✦</div><div><div class="co-row-lbl">Preferred partner</div><div class="co-row-val">American Express</div></div></div><span class="co-row-arrow">›</span></div>
    </div>
    <div class="co-section">
      <div class="co-label">Order Summary</div>
      <div class="co-items">
        <div class="co-item"><div class="co-item-img coi-1" style="background-image:url('https://images.unsplash.com/photo-1567538096630-e0c55bd6374c?w=200&q=92');background-size:cover;background-position:center;background-color:#F0EBE3;"></div><div><div class="co-item-name">Caristo Armchair</div><div class="co-item-hotel">ART LAB · Mondrian LDN</div></div><div class="co-item-price">$750</div></div>
        <div class="co-item"><div class="co-item-img coi-2" style="background-image:url('https://images.unsplash.com/photo-1513506003901-1e6a35549a2d?w=200&q=92');background-size:cover;background-position:center;background-color:#1A1410;"></div><div><div class="co-item-name">Brass Floor Lamp</div><div class="co-item-hotel">Porta Romana · Standard LDN</div></div><div class="co-item-price">$890</div></div>
        <div class="co-item"><div class="co-item-img coi-3" style="background-image:url('https://images.unsplash.com/photo-1538688525198-9b88f6f53126?w=200&q=92');background-size:cover;background-position:center;background-color:#E8E0D4;"></div><div><div class="co-item-name">Walnut Side Table</div><div class="co-item-hotel">Vitra · 25hours Vienna</div></div><div class="co-item-price">$299</div></div>
      </div>
      <div class="co-totals">
        <div class="co-total-row"><span class="co-total-lbl">Subtotal</span><span class="co-total-val">$1,939.00</span></div>
        <div class="co-total-row"><span class="co-total-lbl">Shipping</span><span class="co-total-val">Free</span></div>
        <div class="co-total-row"><span class="co-total-lbl">Tax</span><span class="co-total-val">$0.00</span></div>
        <div class="co-total-row"><span class="co-total-lbl">Total</span><span class="co-total-val">$1,939.00</span></div>
      </div>
      <button class="submit-btn" onclick="submitOrder()">Submit Order</button>
      <div class="co-guest">Already have an account? <span onclick="toast('Sign in coming soon')">Sign In</span> · <span onclick="toast('Guest checkout coming soon')">Guest</span></div>
    </div>
    <span class="back-link" onclick="gotoStep(4)">← Back to Complete the Look</span>
  </div>

  <!-- Success -->
  <div class="step-panel" id="sp-ok">
    <div class="success-wrap">
      <div class="success-icon">✓</div>
      <div class="success-title">Order Placed!</div>
      <div class="success-sub">Your Hand Selected pieces are confirmed. You will receive a tracking update within 24 hours.</div>
      <div class="success-order-label">Order Number</div>
      <div class="success-order-num">#HS-20260222</div>
      <button class="next-btn" style="width:100%;margin:0;" onclick="goTo('s-home','tab-home');resetScan()">Continue Shopping</button>
    </div>
  </div>
</div>

<!-- ════════════════════════
     AI MOODBOARD
════════════════════════ -->
<div class="screen screen-dark" id="s-moodboard">
  <div class="sb"></div>
  <div class="topbar topbar-dark">
    <div class="logo logo-light">AI <span>Moodboard</span></div>
    <button class="ibtn ibtn-light" onclick="toast('Upload your room to get started')">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/></svg>
    </button>
  </div>

  <div class="mb-intro" id="mbIntro">
    <div class="mb-eyebrow">Powered by AI</div>
    <div class="mb-title">See your cart in<br>your actual home.</div>
    <div class="mb-sub">Upload a photo of your living room and our AI will show you exactly how to position your Hand Selected items — with personalized styling advice.</div>
  </div>

  <label class="upload-zone" id="mbUploadZone" style="cursor:pointer;position:relative;overflow:hidden;">
    <input type="file" id="roomFile" accept="image/*" style="position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;font-size:0;" onchange="handleUpload(event)">
    <div class="upload-icon-wrap">🛋️</div>
    <div class="upload-title">Upload Your Room</div>
    <div class="upload-sub">Tap to upload a photo of your living room, bedroom, or any space you are decorating</div>
  </label>

  <div class="upload-btns" id="mbUploadBtns">
    <label class="upload-btn upload-btn-gold" style="cursor:pointer;position:relative;overflow:hidden;">
      <input type="file" accept="image/*" style="position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;font-size:0;" onchange="handleUpload(event)">
      <span style="pointer-events:none;">📷 Upload Photo</span>
    </label>
    <label class="upload-btn upload-btn-ghost" style="cursor:pointer;position:relative;overflow:hidden;">
      <input type="file" accept="image/*" capture="environment" style="position:absolute;inset:0;opacity:0;cursor:pointer;width:100%;height:100%;font-size:0;" onchange="handleUpload(event)">
      <span style="pointer-events:none;">📸 Take Photo</span>
    </label>
  </div>

  <div class="room-preview-wrap" id="mbRoomPreview">
    <img id="roomPreviewImg" src="" alt="Your room">
    <div class="room-label">Your Room</div>
    <div class="room-pin" style="top:40%;left:22%;" onclick="toast('Caristo Armchair — place here')"></div>
    <div class="room-pin" style="top:28%;right:26%;animation-delay:0.6s;" onclick="toast('Brass Lamp — corner spot')"></div>
    <div class="room-pin" style="bottom:32%;left:54%;animation-delay:1.2s;" onclick="toast('Side Table — next to seating')"></div>
  </div>

  <div class="ai-gen" id="mbAiGen">
    <div class="ai-spinner ai-spin" style="width:46px;height:46px;border-radius:50%;border:2px solid rgba(201,169,110,0.2);border-top-color:var(--gold);flex-shrink:0;"></div>
    <div class="ai-gen-title">Analyzing your space...</div>
    <div class="ai-gen-sub">Our AI is studying your room layout, lighting, and aesthetic to create your personalized moodboard.</div>
  </div>

  <div class="mb-result" id="mbResult">
    <div class="mb-result-title">Your Styled Space</div>
    <div class="mb-result-sub">Based on your room palette and layout, here is how to position your Hand Selected pieces.</div>
    <div class="mb-ai-card">
      <div class="mb-ai-eyebrow">✦ AI Stylist</div>
      <div class="mb-ai-quote" id="mbQuote">"Your space has beautiful natural light and a warm neutral base that will make the Caristo Armchair shine. Position it near the window to create an inviting reading corner. The Brass Lamp belongs on the side table to your right — it will cast a warm evening glow that complements your existing tones perfectly."</div>
    </div>
    <div class="mb-placement"><div class="mb-placement-img mbi-1"></div><div><div class="mb-placement-name">Caristo Armchair</div><div class="mb-placement-tip">Position near your window for natural light. Face toward the room center for conversation flow.</div><div class="mb-placement-pos">📍 Northwest corner, facing southeast</div></div></div>
    <div class="mb-placement"><div class="mb-placement-img mbi-2"></div><div><div class="mb-placement-name">Brass Floor Lamp</div><div class="mb-placement-tip">Place behind and to the right of the armchair. Creates layered lighting and visual height.</div><div class="mb-placement-pos">📍 Behind seating, right side</div></div></div>
    <div class="mb-placement"><div class="mb-placement-img mbi-3"></div><div><div class="mb-placement-name">Walnut Side Table</div><div class="mb-placement-tip">Directly beside the armchair at seat height. Style with the amber candle and a single book.</div><div class="mb-placement-pos">📍 Right of armchair, within reach</div></div></div>
    <button class="mb-regen" onclick="regenMoodboard()">✦ Regenerate Layout</button>
    <button class="next-btn" style="margin:0 0 16px;" onclick="goTo('s-scan',null);gotoStep(1)">Shop These Items <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M5 12h14M12 5l7 7-7 7"/></svg></button>
  </div>
</div>

<!-- ════════════════════════
     HOTELS
════════════════════════ -->
<div class="screen screen-light" id="s-hotels">
  <div class="sb"></div>
  <div class="topbar topbar-light"><div class="logo logo-dark">Hotels</div></div>
  <div class="hotel-card hc-1" style="background-image:url('https://images.unsplash.com/photo-1551882547-ff40c63fe5fa?w=800&q=80');background-size:cover;background-position:center;" onclick="toast('Loading Mondrian London...')"><div class="hc-badge">Launch Partner</div><div class="hc-overlay"><div class="hc-name">Mondrian London</div><div class="hc-loc">London, UK</div><div class="hc-foot"><span class="hc-count">38 items</span><div class="hc-arrow">→</div></div></div></div>
  <div class="hotel-card hc-2" style="background-image:url('https://images.unsplash.com/photo-1578683010236-d716f9a3f461?w=800&q=80');background-size:cover;background-position:center;" onclick="toast('Loading The Standard London...')"><div class="hc-badge">New</div><div class="hc-overlay"><div class="hc-name">The Standard</div><div class="hc-loc">London, UK</div><div class="hc-foot"><span class="hc-count">29 items</span><div class="hc-arrow">→</div></div></div></div>
  <div class="hotel-card hc-3" style="background-image:url('https://images.unsplash.com/photo-1566665797739-1674de7a421a?w=800&q=80');background-size:cover;background-position:center;" onclick="toast('Loading 25hours Vienna...')"><div class="hc-badge" style="background:var(--gold-lt);color:var(--ink)">Design Icon</div><div class="hc-overlay"><div class="hc-name">25hours Vienna</div><div class="hc-loc">Vienna, Austria</div><div class="hc-foot"><span class="hc-count">34 items</span><div class="hc-arrow">→</div></div></div></div>
  <div class="hotel-card hc-4" style="background-image:url('https://images.unsplash.com/photo-1564501049412-61c2a3083791?w=800&q=80');background-size:cover;background-position:center;" onclick="toast('Loading W Amsterdam...')"><div class="hc-overlay"><div class="hc-name">W Amsterdam</div><div class="hc-loc">Amsterdam, Netherlands</div><div class="hc-foot"><span class="hc-count">41 items</span><div class="hc-arrow">→</div></div></div></div>
  <div class="hotel-card hc-5" style="background-image:url('https://images.unsplash.com/photo-1571003123894-1f0594d2b5d9?w=800&q=80');background-size:cover;background-position:center;" onclick="toast('Loading SLS Barcelona...')"><div class="hc-overlay"><div class="hc-name">SLS Barcelona</div><div class="hc-loc">Barcelona, Spain</div><div class="hc-foot"><span class="hc-count">27 items</span><div class="hc-arrow">→</div></div></div></div>
</div>

<!-- ════════════════════════
     WISHLIST
════════════════════════ -->
<div class="screen screen-light" id="s-wishlist">
  <div class="sb"></div>
  <div class="topbar topbar-light"><div class="logo logo-dark">Saved</div></div>
  <div class="wl-grid">
    <div class="wl-card" onclick="openSheet('Linen Armchair','$2,400','Mondrian London','Furniture','Handcrafted Belgian linen armchair.','pi-1')"><div class="wl-img wl-1" style="background-image:url('https://images.unsplash.com/photo-1493663284031-b7e3aefcae8e?w=700&q=95');background-size:cover;background-position:center;background-color:#F0EBE3;"></div><button class="wl-rm" onclick="event.stopPropagation();toast('Removed from saved')">×</button><div class="wl-info"><div class="wl-name">Linen Armchair</div><div class="wl-price">$2,400</div></div></div>
    <div class="wl-card" onclick="openSheet('Brass Table Lamp','$890','The Standard London','Lighting','Brushed brass lamp.','pi-2')"><div class="wl-img wl-2" style="background-image:url('https://images.unsplash.com/photo-1540932239986-30128078f3c5?w=700&q=95');background-size:cover;background-position:center;background-color:#1A1410;"></div><button class="wl-rm" onclick="event.stopPropagation();toast('Removed from saved')">×</button><div class="wl-info"><div class="wl-name">Brass Table Lamp</div><div class="wl-price">$890</div></div></div>
    <div class="wl-card" onclick="openSheet('Linen Bedding','$480','25hours Vienna','Linens','Egyptian cotton bedding.','pi-3')"><div class="wl-img wl-3" style="background-image:url('https://images.unsplash.com/photo-1584100936595-c0654b55a2e2?w=700&q=95');background-size:cover;background-position:center top;background-color:#F5F0E8;"></div><button class="wl-rm" onclick="event.stopPropagation();toast('Removed from saved')">×</button><div class="wl-info"><div class="wl-name">Linen Bedding</div><div class="wl-price">$480</div></div></div>
    <div class="wl-card" onclick="openSheet('Amber Candle','$95','Mondrian London','Candles','Signature hotel scent.','pi-5')"><div class="wl-img wl-4" style="background-image:url('https://images.unsplash.com/photo-1608181831718-c9fca6c938e6?w=700&q=95');background-size:cover;background-position:center;background-color:#1C1410;"></div><button class="wl-rm" onclick="event.stopPropagation();toast('Removed from saved')">×</button><div class="wl-info"><div class="wl-name">Amber Candle</div><div class="wl-price">$95</div></div></div>
  </div>
</div>

<!-- ════════════════════════
     PROFILE
════════════════════════ -->
<div class="screen screen-light" id="s-profile">
  <div class="sb"></div>
  <div class="topbar topbar-light"><div class="logo logo-dark">Profile</div></div>
  <div class="profile-hero">
    <div class="profile-avatar">B</div>
    <div><div class="profile-name">Byron Cordero</div><div class="profile-member">Gold Member</div></div>
  </div>
  <div class="profile-stats">
    <div class="profile-stat"><div class="ps-num">12</div><div class="ps-label">Orders</div></div>
    <div class="profile-stat"><div class="ps-num">4</div><div class="ps-label">Saved</div></div>
    <div class="profile-stat"><div class="ps-num">7</div><div class="ps-label">Hotels</div></div>
  </div>
  <div class="profile-menu">
    <div class="profile-item" onclick="toast('Opening orders...')"><div class="pi-left"><div class="pi-icon">📦</div><span class="pi-label">My Orders</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="goTo('s-wishlist','tab-wishlist')"><div class="pi-left"><div class="pi-icon">♡</div><span class="pi-label">Saved Items</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="goTo('s-moodboard','tab-moodboard')"><div class="pi-left"><div class="pi-icon">✦</div><span class="pi-label">AI Moodboard</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="toast('Hotel visit history coming soon')"><div class="pi-left"><div class="pi-icon">🏨</div><span class="pi-label">Hotel Visits</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="toast('Referral program coming soon!')"><div class="pi-left"><div class="pi-icon">🎁</div><span class="pi-label">Refer a Friend</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="toast('Notifications')"><div class="pi-left"><div class="pi-icon">🔔</div><span class="pi-label">Notifications</span></div><span class="pi-arrow">›</span></div>
    <div class="profile-item" onclick="toast('Settings')"><div class="pi-left"><div class="pi-icon">⚙️</div><span class="pi-label">Settings</span></div><span class="pi-arrow">›</span></div>
  </div>
</div>

<!-- ════════════════════════
     TAB BAR
════════════════════════ -->
<div class="tabbar">
  <button class="tab active" id="tab-home" onclick="goTo('s-home',this.id)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
    <span>Discover</span>
  </button>
  <button class="tab" id="tab-hotels" onclick="goTo('s-hotels',this.id)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><rect x="9" y="13" width="6" height="8"/></svg>
    <span>Hotels</span>
  </button>
  <div class="scan-tab" onclick="goTo('s-scan',null);gotoStep(1)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/><circle cx="12" cy="13" r="4"/></svg>
  </div>
  <button class="tab" id="tab-wishlist" onclick="goTo('s-wishlist',this.id)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
    <span>Saved</span>
  </button>
  <button class="tab" id="tab-profile" onclick="goTo('s-profile',this.id)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
    <span>Profile</span>
  </button>
</div>

<!-- ════════════════════════
     PRODUCT SHEET
════════════════════════ -->
<div class="backdrop" id="backdrop" onclick="closeAll()"></div>
<div class="sheet" id="prodSheet">
  <div class="handle"></div>
  <div class="sheet-img-wrap"><div id="sheetImgBg" style="width:100%;height:100%;background:#1a1713;background-size:cover;background-position:center;"></div></div>
  <div class="sheet-body">
    <div class="sheet-hotel-tag" id="sheetHotel">Hotel</div>
    <div class="sheet-prod-name" id="sheetName">Product</div>
    <div class="sheet-prod-cat" id="sheetCat">Category</div>
    <div class="sheet-prod-price" id="sheetPrice">$0</div>
    <p class="sheet-prod-desc" id="sheetDesc">Description</p>
    <div class="sheet-divider"></div>
    <div class="sheet-details">
      <div class="sheet-detail"><div class="detail-label">Material</div><div class="detail-val">Belgian Linen</div></div>
      <div class="sheet-detail"><div class="detail-label">Origin</div><div class="detail-val">Portugal</div></div>
      <div class="sheet-detail"><div class="detail-label">Lead Time</div><div class="detail-val">4–6 weeks</div></div>
      <div class="sheet-detail"><div class="detail-label">Availability</div><div class="detail-val">In Stock</div></div>
    </div>
  </div>
  <div style="padding:0 0 6px;">
    <div class="sheet-lfl-title">Looks for Less</div>
    <div class="sheet-lfl-row">
      <div class="slfl-card" onclick="addToCart();toast('Alternative added!')"><div class="slfl-img slfl-i1"></div><div class="slfl-body"><div class="slfl-price">$399</div><div class="slfl-save">Save 83%</div></div></div>
      <div class="slfl-card" onclick="addToCart();toast('Alternative added!')"><div class="slfl-img slfl-i2"></div><div class="slfl-body"><div class="slfl-price">$249</div><div class="slfl-save">Save 90%</div></div></div>
      <div class="slfl-card" onclick="addToCart();toast('Alternative added!')"><div class="slfl-img slfl-i3"></div><div class="slfl-body"><div class="slfl-price">$480</div><div class="slfl-save">Save 80%</div></div></div>
    </div>
  </div>
  <div class="sheet-actions">
    <button class="sheet-save-btn" onclick="saveItem()">♡</button>
    <button class="sheet-room-btn" onclick="closeAll();goTo('s-moodboard','tab-moodboard')">See in My Room</button>
    <button class="sheet-add-btn" onclick="addToCart();closeAll()">Add to Bag</button>
  </div>
</div>

<!-- ════════════════════════
     CART SHEET
════════════════════════ -->
<div class="sheet sheet-dark" id="cartSheet">
  <div class="handle handle-dark"></div>
  <div class="cart-head">
    <div class="cart-title">Your Bag <span style="font-family:'DM Sans',sans-serif;font-size:13px;color:var(--muted);" id="cartCount">(3)</span></div>
    <button class="cart-close" onclick="closeAll()">×</button>
  </div>
  <div class="cart-items">
    <div class="cart-item"><div class="cart-item-img cii-1" style="background-image:url('https://images.unsplash.com/photo-1567538096630-e0c55bd6374c?w=200&q=92');background-size:cover;background-position:center;background-color:#F0EBE3;"></div><div style="flex:1;"><div class="cart-item-name">Linen Armchair</div><div class="cart-item-hotel">Mondrian London</div><div class="cart-item-price">$2,400</div></div><button class="cart-rm" onclick="toast('Item removed')">×</button></div>
    <div class="cart-item"><div class="cart-item-img cii-2" style="background-image:url('https://images.unsplash.com/photo-1513506003901-1e6a35549a2d?w=200&q=92');background-size:cover;background-position:center;background-color:#1A1410;"></div><div style="flex:1;"><div class="cart-item-name">Brass Table Lamp</div><div class="cart-item-hotel">The Standard London</div><div class="cart-item-price">$890</div></div><button class="cart-rm" onclick="toast('Item removed')">×</button></div>
    <div class="cart-item"><div class="cart-item-img cii-3" style="background-image:url('https://images.unsplash.com/photo-1602028915047-37269d1a73f7?w=200&q=92');background-size:cover;background-position:center;background-color:#1C1410;"></div><div style="flex:1;"><div class="cart-item-name">Amber Candle</div><div class="cart-item-hotel">Mondrian London</div><div class="cart-item-price">$95</div></div><button class="cart-rm" onclick="toast('Item removed')">×</button></div>
  </div>
  <div class="cart-foot">
    <div class="cart-total-row"><span class="cart-total-label">Total</span><span class="cart-total-amount">$3,385</span></div>
    <button class="cart-checkout-btn" onclick="closeAll();goTo('s-scan',null);gotoStep(5)">Proceed to Checkout</button>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toastEl"><span class="toast-dot"></span><span id="toastMsg">Done</span></div>

<script>
var cartNum = 3;

function goTo(screenId, tabId) {
  // hide all screens
  var screens = document.querySelectorAll('.screen');
  for (var i = 0; i < screens.length; i++) {
    screens[i].classList.remove('active');
  }
  // show target
  document.getElementById(screenId).classList.add('active');
  // update tabs
  if (tabId) {
    var tabs = document.querySelectorAll('.tab');
    for (var i = 0; i < tabs.length; i++) {
      tabs[i].classList.remove('active');
    }
    var el = document.getElementById(tabId);
    if (el) el.classList.add('active');
  }
  closeAll();
}

function gotoStep(n) {
  var panels = document.querySelectorAll('.step-panel');
  for (var i = 0; i < panels.length; i++) {
    panels[i].classList.remove('active');
  }
  var target = document.getElementById('sp' + n) || document.getElementById('sp-ok');
  if (target) target.classList.add('active');
  for (var i = 1; i <= 5; i++) {
    var dot = document.getElementById('sd' + i);
    var line = document.getElementById('sl' + i);
    if (!dot) continue;
    dot.classList.remove('active','done');
    if (i < n) dot.classList.add('done');
    else if (i === n) dot.classList.add('active');
    if (line) {
      line.classList.remove('done');
      if (i < n) line.classList.add('done');
    }
  }
  var scan = document.getElementById('s-scan');
  if (scan) scan.scrollTop = 0;
}

function resetScan() {
  document.getElementById('stepNav').style.display = 'flex';
  gotoStep(1);
}

function submitOrder() {
  cartNum = 0;
  document.getElementById('cartBadge').textContent = '0';
  document.getElementById('cartCount').textContent = '(0)';
  var panels = document.querySelectorAll('.step-panel');
  for (var i = 0; i < panels.length; i++) {
    panels[i].classList.remove('active');
  }
  document.getElementById('sp-ok').classList.add('active');
  document.getElementById('stepNav').style.display = 'none';
}

var sheetImages = {
  'pi-1': 'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=1000&q=95',
  'pi-2': 'https://images.unsplash.com/photo-1540932239986-30128078f3c5?w=1000&q=95',
  'pi-3': 'https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=1000&q=95',
  'pi-4': 'https://images.unsplash.com/photo-1618221118493-9cfa1a1191cf?w=1000&q=95',
  'pi-5': 'https://images.unsplash.com/photo-1608181831718-c9fca6c938e6?w=1000&q=95',
  'pi-6': 'https://images.unsplash.com/photo-1580502304784-8985b7eb7260?w=1000&q=95'
};

function openSheet(name, price, hotel, cat, desc, imgClass) {
  document.getElementById('sheetName').textContent = name;
  document.getElementById('sheetPrice').textContent = price;
  document.getElementById('sheetHotel').textContent = hotel;
  document.getElementById('sheetCat').textContent = cat;
  document.getElementById('sheetDesc').textContent = desc;
  var bg = document.getElementById('sheetImgBg');
  bg.className = imgClass;
  bg.style.width = '100%';
  bg.style.height = '100%';
  if (sheetImages[imgClass]) {
    bg.style.backgroundImage = 'url(' + sheetImages[imgClass].url + ')';
    bg.style.backgroundSize = 'cover';
    bg.style.backgroundPosition = 'center';
    bg.style.backgroundColor = sheetImages[imgClass].bg;
  }
  document.getElementById('backdrop').classList.add('open');
  document.getElementById('prodSheet').classList.add('open');
}

function openCart() {
  document.getElementById('backdrop').classList.add('open');
  document.getElementById('cartSheet').classList.add('open');
}

function closeAll() {
  document.getElementById('backdrop').classList.remove('open');
  document.getElementById('prodSheet').classList.remove('open');
  document.getElementById('cartSheet').classList.remove('open');
}

function addToCart() {
  cartNum++;
  document.getElementById('cartBadge').textContent = cartNum;
  document.getElementById('cartCount').textContent = '(' + cartNum + ')';
  toast('Added to your bag ✓');
}

function saveItem() { toast('Saved to wishlist ♡'); }

function toast(msg) {
  var el = document.getElementById('toastEl');
  document.getElementById('toastMsg').textContent = msg;
  el.classList.add('show');
  setTimeout(function() { el.classList.remove('show'); }, 2500);
}

function filterChip(el, label) {
  var chips = document.querySelectorAll('.chip');
  for (var i = 0; i < chips.length; i++) chips[i].classList.remove('active');
  el.classList.add('active');
  toast(label === 'All' ? 'Showing all items' : 'Filtered: ' + label);
}

function toggleCheck(el) {
  var check = el.querySelector('.id-check');
  check.classList.toggle('on');
}

function toggleCtl(el) {
  el.classList.toggle('on');
  var action = el.querySelector('.ctl-item-action');
  if (el.classList.contains('on')) {
    action.textContent = '✓ Added';
    addToCart();
  } else {
    action.textContent = '+ Add';
    cartNum = Math.max(0, cartNum - 1);
    document.getElementById('cartBadge').textContent = cartNum;
    document.getElementById('cartCount').textContent = '(' + cartNum + ')';
  }
}

function handleUpload(event) {
  var file = event.target.files[0];
  if (!file) return;
  var reader = new FileReader();
  reader.onload = function(e) {
    document.getElementById('mbIntro').style.display = 'none';
    document.getElementById('mbUploadZone').style.display = 'none';
    document.getElementById('mbUploadBtns').style.display = 'none';
    var preview = document.getElementById('mbRoomPreview');
    document.getElementById('roomPreviewImg').src = e.target.result;
    preview.style.display = 'block';
    var gen = document.getElementById('mbAiGen');
    gen.style.display = 'flex';
    setTimeout(function() {
      gen.style.display = 'none';
      document.getElementById('mbResult').style.display = 'block';
      toast('✦ Your moodboard is ready!');
    }, 3000);
  };
  reader.readAsDataURL(file);
}

function regenMoodboard() {
  document.getElementById('mbResult').style.display = 'none';
  var gen = document.getElementById('mbAiGen');
  gen.style.display = 'flex';
  var quotes = [
    '"Your room\'s high ceilings create a wonderful canvas. Anchor the Caristo Armchair where morning light will highlight its linen texture. Layer the Brass Lamp behind for warm evening ambiance."',
    '"The warm tones in your space pair beautifully with the walnut pieces. Center the Side Table beside your main seating and let the Brass Lamp create a soft triangle of light."',
    '"Strong natural light is your greatest asset. Position the Caristo Armchair facing the light so the Belgian linen glows. Add the Amber Candle as a warm evening counterpoint."'
  ];
  setTimeout(function() {
    gen.style.display = 'none';
    document.getElementById('mbQuote').textContent = quotes[Math.floor(Math.random() * quotes.length)];
    document.getElementById('mbResult').style.display = 'block';
    toast('✦ New layout generated');
  }, 2500);
}
function handleScanUpload(event) {
  var file = event.target.files[0];
  if (!file) return;

  var reader = new FileReader();
  reader.onload = function(e) {
    var base64 = e.target.result;
    var base64Data = base64.split(',')[1];
    var mimeType = file.type || 'image/jpeg';

    // Show the uploaded photo in step 2 preview
    var previewImg = document.getElementById('scanPreviewImg');
    if (previewImg) {
      previewImg.src = base64;
      previewImg.style.display = 'block';
    }

    // Show analyzing overlay in step 1
    var analyzing = document.getElementById('scanAnalyzing');
    if (analyzing) {
      analyzing.style.display = 'flex';
    }

    // Call Anthropic API to identify items in the image
    identifyRoomItems(base64Data, mimeType);
  };
  reader.readAsDataURL(file);
}

async function identifyRoomItems(base64Data, mimeType) {
  try {
    var response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        messages: [{
          role: 'user',
          content: [
            {
              type: 'image',
              source: { type: 'base64', media_type: mimeType, data: base64Data }
            },
            {
              type: 'text',
              text: 'You are a luxury home decor product identification AI for Hand Selected, an app that lets users shop hotel room furniture and decor. Analyze this image and identify up to 4 distinct furniture or decor items visible. For each item provide: a product name, a plausible luxury brand name, an estimated retail price in USD, and a one-sentence description. Respond ONLY with a JSON array, no markdown, no backticks. Format: [{"name":"","brand":"","hotel":"","price":"$X,XXX","description":"","color":"#hex for a gradient swatch"}]. Use realistic luxury hotel brands and prices. If this is not an interior room photo, still identify any furniture or decor objects visible. Always return valid JSON array with 2-4 items.'
            }
          ]
        }]
      })
    });

    var data = await response.json();
    var text = data.content && data.content[0] && data.content[0].text;

    if (!text) throw new Error('No response');

    // Parse JSON
    var clean = text.replace(/```json|```/g, '').trim();
    var items = JSON.parse(clean);

    // Hide analyzing overlay
    var analyzing = document.getElementById('scanAnalyzing');
    if (analyzing) analyzing.style.display = 'none';

    // Update badge
    var badge = document.getElementById('scanBadge');
    if (badge) badge.textContent = items.length + ' Items Found';

    // Render identified items
    renderIdentifiedItems(items);

    // Go to step 2
    gotoStep(2);

  } catch(err) {
    console.error('AI scan error:', err);
    // Hide analyzing overlay
    var analyzing = document.getElementById('scanAnalyzing');
    if (analyzing) analyzing.style.display = 'none';
    // Fall back to step 2 with default items
    toast('AI scan complete — showing matches');
    gotoStep(2);
  }
}

var swatchColors = ['sw-1','sw-2','sw-3','sw-4'];

function renderIdentifiedItems(items) {
  var swatches = ['sw-1','sw-2','sw-3','sw-4'];
  var container = document.getElementById('identifiedItemsList');
  if (!container) return;
  container.innerHTML = '';

  items.forEach(function(item, i) {
    var div = document.createElement('div');
    div.className = 'id-item';
    div.onclick = function() { toggleCheck(div); };

    var swatchClass = swatches[i % swatches.length];
    var swatchStyle = item.color ? 'background:' + item.color + ';' : '';

    div.innerHTML =
      '<div class="id-swatch ' + swatchClass + '" style="' + swatchStyle + '"></div>' +
      '<div class="id-info">' +
        '<div class="id-name">' + item.name + '</div>' +
        '<div class="id-brand">' + item.brand + (item.hotel ? ' · ' + item.hotel : '') + '</div>' +
        '<div class="id-price">' + item.price + '</div>' +
      '</div>' +
      '<div class="id-check on">✓</div>';

    container.appendChild(div);
  });
}

// ── LIVE CAMERA ──────────────────────────────────
var cameraStream = null;
var facingMode = 'environment'; // rear camera by default

function startCamera() {
  var video = document.getElementById('cameraFeed');
  if (!video) return;

  // Stop any existing stream
  if (cameraStream) {
    cameraStream.getTracks().forEach(function(t) { t.stop(); });
    cameraStream = null;
  }

  var constraints = {
    video: {
      facingMode: facingMode,
      width: { ideal: 1280 },
      height: { ideal: 1280 }
    },
    audio: false
  };

  navigator.mediaDevices.getUserMedia(constraints)
    .then(function(stream) {
      cameraStream = stream;
      video.srcObject = stream;
      video.style.display = 'block';
      document.getElementById('scanLineEl').style.display = 'block';
      document.getElementById('camDenied').style.display = 'none';
      document.getElementById('cameraCanvas').style.display = 'none';
    })
    .catch(function(err) {
      console.error('Camera error:', err);
      document.getElementById('camDenied').style.display = 'flex';
      document.getElementById('scanLineEl').style.display = 'none';
    });
}

function stopCamera() {
  if (cameraStream) {
    cameraStream.getTracks().forEach(function(t) { t.stop(); });
    cameraStream = null;
  }
}

function switchCamera() {
  facingMode = (facingMode === 'environment') ? 'user' : 'environment';
  startCamera();
}

function capturePhoto() {
  var video = document.getElementById('cameraFeed');
  var canvas = document.getElementById('cameraCanvas');
  if (!video || !cameraStream) {
    toast('Camera not ready — try Upload instead');
    return;
  }

  // Draw current video frame to canvas
  canvas.width = video.videoWidth || 640;
  canvas.height = video.videoHeight || 640;
  var ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

  // Freeze frame — hide video, show canvas
  video.style.display = 'none';
  canvas.style.display = 'block';
  stopCamera();

  // Show analyzing overlay
  var analyzing = document.getElementById('scanAnalyzing');
  analyzing.style.display = 'flex';

  // Get base64 image data
  var dataUrl = canvas.toDataURL('image/jpeg', 0.85);
  var base64Data = dataUrl.split(',')[1];

  // Send to AI
  identifyRoomItems(base64Data, 'image/jpeg');
}

// Override handleScanUpload to also stop camera when file is uploaded
var _origHandleScanUpload = handleScanUpload;
handleScanUpload = function(event) {
  stopCamera();
  _origHandleScanUpload(event);
};

// Start camera when scan screen becomes active
var _origGoTo = goTo;
goTo = function(screenId, tabId) {
  _origGoTo(screenId, tabId);
  if (screenId === 's-scan') {
    setTimeout(startCamera, 100);
  } else {
    stopCamera();
  }
};

// Also start camera when scan tab button is clicked directly
var scanTabBtn = document.querySelector('.scan-tab');
if (scanTabBtn) {
  scanTabBtn.addEventListener('click', function() {
    setTimeout(startCamera, 200);
  });
}

// Start camera on page load if scan is the active screen
window.addEventListener('load', function() {
  if (document.getElementById('s-scan').classList.contains('active')) {
    startCamera();
  }
});

</script>
</div>
</body>
</html>
